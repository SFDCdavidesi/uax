<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UAX - Test Oficial Estructura de Computadores</title>
    <style>
        :root {
            --primary: #2563eb;
            --success: #059669;
            --error: #dc2626;
            --bg: #f1f5f9;
            --card: #ffffff;
            --text: #0f172a;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            position: sticky;
            top: 0;
            background: var(--card);
            width: 100%;
            max-width: 600px;
            padding: 15px;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            z-index: 1000;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat { text-align: center; }
        .stat-val { display: block; font-weight: 800; font-size: 1.2rem; }
        .stat-label { font-size: 0.7rem; color: #64748b; text-transform: uppercase; }

        .shuffle-btn {
            grid-column: span 3;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .quiz-container { width: 100%; max-width: 600px; }

        .q-card {
            background: var(--card);
            padding: 18px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .unit-badge {
            background: #e2e8f0;
            color: #475569;
            padding: 2px 8px;
            border-radius: 5px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .question-text {
            font-size: 1rem;
            font-weight: 600;
            margin: 12px 0;
            line-height: 1.4;
            white-space: pre-wrap; /* Para preservar el formato del cÃ³digo en UD4 */
        }

        .option {
            padding: 12px;
            border: 2px solid #f1f5f9;
            border-radius: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
            background: #fdfdfd;
        }

        .disabled { pointer-events: none; }
        .correct { background: #dcfce7 !important; border-color: var(--success) !important; color: #166534; }
        .wrong { background: #fee2e2 !important; border-color: var(--error) !important; color: #991b1b; }

        #results-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(0,0,0,0.3);
            text-align: center;
            z-index: 2000;
            width: 80%;
            max-width: 400px;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1999;
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="stat"><span class="stat-val" id="hits">0</span><span class="stat-label">Aciertos</span></div>
        <div class="stat"><span class="stat-val" id="fails">0</span><span class="stat-label">Fallos</span></div>
        <div class="stat"><span class="stat-val" id="current">0/60</span><span class="stat-label">Progreso</span></div>
        <button class="shuffle-btn" onclick="initQuiz()">ðŸŽ² Mezclar y Reiniciar</button>
    </div>

    <div class="quiz-container" id="quiz-box"></div>

    <div class="overlay" id="overlay"></div>
    <div id="results-modal">
        <h2>ðŸŽ‰ Â¡Fin del Test!</h2>
        <div id="final-stats" style="margin: 20px 0; line-height: 2;"></div>
        <button class="shuffle-btn" onclick="initQuiz(); document.getElementById('results-modal').style.display='none'; document.getElementById('overlay').style.display='none';">ðŸ”„ Volver a intentar</button>
    </div>

    <script>
        const rawQuestions = [
            // UD1
            {u:"UD1", q:"Los transistores pertenecen  a la generaciÃ³n de computadores ...", o:["Tercera.", "Primera.", "Cuarta.", "Segunda."], c:3},
            {u:"UD1", q:"En una memoria:", o:["Tenemos tantos bits almacenados como 2 elevado al nÃºmero de lÃ­neas.", "La cantidad total de datos almacenada es potencia de 2.", "En cada posiciÃ³n de memoria hay almacenado un dato Ãºtil.", "El nÃºmero de posiciones de memoria es 2 elevado al nÃºmero de bits de su entrada de datos."], c:1},
            {u:"UD1", q:"Como estudiantes reciÃ©n graduados, en nuestro primer trabajo, nos piden diseÃ±ar una computadora para un sistema empotrado, Â¿quÃ© tipo de arquitectura recomendarÃ­as utilizar?", o:["Un Macintosh.", "Harvard.", "Von Neumann.", "Un servidor Windows."], c:1},
            {u:"UD1", q:"Respecto a la arquitectura de un computador:", o:["Es von Neumann si el bus de datos y el de instrucciones es compartido.", "Es Harvard si los datos y el control comparten bus.", "Es Harvard si las instrucciones tienen el mismo tamaÃ±o que los datos y viajan por el mismo bus.", "Es Harvard si el ancho de palabra no es igual al tamaÃ±o de instrucciÃ³n."], c:0},
            {u:"UD1", q:"Una memoria volÃ¡til se caracteriza por ...", o:["Parte del computador donde se almacenan datos.", "Se pierde la informaciÃ³n si se interrumpe el flujo elÃ©ctrico.", "No necesitar energÃ­a para perdurar.", "Ninguna de las otras respuestas."], c:1},
            {u:"UD1", q:"El registro de instrucciÃ³n ...", o:["Contiene los valores sobre los que se va a ejecutar la instrucciÃ³n.", "Ninguna de las otras respuestas.", "Contiene la siguiente instrucciÃ³n a ejecutar en cÃ³digo ensamblador.", "Contiene la actual instrucciÃ³n a ejecutar en cÃ³digo ensamblador."], c:1},
            {u:"UD1", q:"Respecto a la arquitectura de un computador:", o:["Es Harvard si las instrucciones pueden tener distinto tamaÃ±o que los datos.", "Es Harvard si las instrucciones no pueden tener distinto tamaÃ±o que los datos.", "Es von Neumann si el bus de datos y el de instrucciones son bidireccionales.", "Es Harvard si usamos el mismo bus para control que para datos."], c:0},
            {u:"UD1", q:"El CP (contador de programa), Â¿a dÃ³nde apunta?", o:["A la siguiente instrucciÃ³n.", "A la instrucciÃ³n en curso.", "A la instrucciÃ³n previamente ejecutada.", "Ninguna de las anteriores."], c:0},
            {u:"UD1", q:"El lenguaje mÃ¡quina ...", o:["Ninguna de las otras respuestas.", "Es un lenguaje de bajo nivel.", "Es un lenguaje de muy alto nivel.", "Es un lenguaje de alto nivel."], c:1},
            {u:"UD1", q:"La primera generaciÃ³n de computadores se caracterizÃ³ por usar:", o:["Circuitos integrados.", "Tubos al vacÃ­o.", "Transistores.", "Chips."], c:1},

            // UD2
            {u:"UD2", q:"Respecto al reloj de un procesador:", o:["Es difÃ­cil comparar dos procesadores de dos arquitecturas distintas.", "El procesador con mÃ¡s frecuencia de reloj es el mÃ¡s rÃ¡pido del mercado en ejecutar todas las tareas.", "La seÃ±al de reloj de un procesador es una sinusoidal entre 0 y 5 voltios.", "El procesador con mÃ¡s MIPS es el procesador mÃ¡s rÃ¡pido del mercado en ejecutar todas las tareas."], c:0},
            {u:"UD2", q:"Respecto al CPI:", o:["A mayor CPI menos MIPS.", "El computador que tiene mÃ¡s ciclos por instrucciÃ³n es el mÃ¡s lento a la hora de ejecutar cualquier tarea.", "Depende de la frecuencia de reloj.", "Todas las instrucciones tienen los mismos ciclos."], c:0},
            {u:"UD2", q:"Â¿CuÃ¡l es el valor de MIPS de un procesador que funciona a 2 MHz y es capaz de ejecutar una media de 3 instrucciones por ciclo?", o:["6.", "3/2.", "No podemos saber el valor de MIPS.", "2000/ 3."], c:0},
            {u:"UD2", q:"SeÃ±ala la falsa:", o:["Los MIPS dependen de la frecuencia de reloj.", "Los MIPS son millones de instrucciones por segundo.", "La velocidad de reloj permite comparar arquitecturas", "Hay que promediar los ciclos de cada instrucciÃ³n para obtener el CPI medio."], c:2},
            {u:"UD2", q:"Sobre arquitectura de computadores:", o:["El paralelismo se detecta antes de la ejecuciÃ³n.", "Las mÃ¡quinas superescalares proporcionan compatibilidad a nivel de cÃ³digo objeto con las mÃ¡squinas escalares.", "Un procesador superescalar de grado m tiene un CPI de m.", "Los procesadores superescalares se utilizan en tareas intensivas de cÃ¡lculo"], c:3},
            {u:"UD2", q:"Un ciclo de 1 ns son:", o:["10 G de frecuencia de reloj.", "1G de frecuencia de reloj.", "No podemos saber la frecuencia de reloj.", "2 G de frecuencia de reloj."], c:1},
            {u:"UD2", q:"Respecto al CPI:", o:["A menos frecuencia de reloj el CPI sube.", "A mÃ¡s frecuencia de reloj el CPI sube.", "No aporta nada sobre la rapidez de ejecuciÃ³n de los programas.", "El CPI depende del programa."], c:2},
            {u:"UD2", q:"Los MFLOPS:", o:["Es un parÃ¡metro de rendimiento universal para todas las arquitecturas.", "A mÃ¡s MFLOPS mÃ¡s rÃ¡pido es un computador al ejecutar cualquier tarea.", "EstÃ¡ relacionados con el CPI.", "Miden todo tipo de operaciones."], c:2},
            {u:"UD2", q:"SeÃ±ala la falsa:", o:["Los multicomputadores tienen memoria compartida.", "Los procesadores vectoriales trabajan sobre vectores de resultados y datos.", "Los procesadores vectoriales ahorran bucles de ejecuciÃ³n.", "Los procesadores segmentados requieren un gran ancho de banda en la memoria."], c:0},
            {u:"UD2", q:"Sobre las tÃ©cnicas para evitar problemas de dependencias en la segmentaciÃ³n:", o:["Se puede solucionar con instrucciones NOP.", "Son solo hardware.", "Son solo software.", "Si se reordenan las instrucciones se solucionan siempre las dependencia."], c:0},

            // UD3
            {u:"UD3", q:"El lenguaje ensamblador:", o:["Es poco parecido entre procesadores distintos, aunque depende de la arquitectura.", "Es lo mismo que el cÃ³digo mÃ¡quina.", "Se llama de bajo nivel porque estÃ¡ mÃ¡s cerca del hardware.", "Se usa a menudo en la programaciÃ³n corriente."], c:2},
            {u:"UD3", q:"Â¿CuÃ¡l es la caracterÃ­stica principal de la arquitectura MIPS32?", o:["No soporta operaciones aritmÃ©ticas.", "Utiliza un conjunto de instrucciones complejo.", "Tiene un conjunto reducido de instrucciones.", "Es una arquitectura CISC."], c:2},
            {u:"UD3", q:"Â¿QuÃ© instrucciÃ³n en MIPS32 se utiliza para sumar dos registros?", o:["SUB", "ADD", "DIV", "MUL"], c:1},
            {u:"UD3", q:"Â¿QuÃ© modo de direccionamiento utiliza un registro base mÃ¡s un valor de desplazamiento?", o:["Direccionamiento inmediato.", "Direccionamiento directo a registro.", "Direccionamiento implÃ­cito.", "Direccionamiento indirecto a registro con desplazamiento."], c:3},
            {u:"UD3", q:"SeÃ±ala la verdadera:", o:["La CPU trabaja internamente en ensamblador.", "Si se introduce el cÃ³digo mÃ¡quina en una memoria, el procesador puede ejecutar ese programa directamente sin necesidad de compilador.", "Si se introduce un cÃ³digo en ensamblador en un compilador, obtenemos el cÃ³digo de alto nivel correspondiente.", "Un programa en ensamblador se escribe en cÃ³digo mÃ¡quina."], c:1},
            {u:"UD3", q:"Â¿QuÃ© significa â€˜Little Endianâ€™ en la ordenaciÃ³n de datos?", o:["No hay una ordenaciÃ³n especÃ­fica.", "Los bytes se ordenan de manera aleatoria.", "El byte menos significativo se coloca en la primera posiciÃ³n.", "El byte mÃ¡s significativo se coloca en la primera posiciÃ³n."], c:2},
            {u:"UD3", q:"SeÃ±ala la verdadera al respecto del MIPS32:", o:["Es CISC.", "Direcciona los perifÃ©ricos como registros.", "Su arquitectura es de carga/almacenamiento.", "Trabaja indistintamente en cualquier modo."], c:2},
            {u:"UD3", q:"Â¿QuÃ© es una pseudoinstrucciÃ³n en MIPS32?", o:["Una instrucciÃ³n que se corresponde directamente con una instrucciÃ³n mÃ¡quina.", "Una instrucciÃ³n que se utiliza solo en modo kernel.", "Una instrucciÃ³n que el ensamblador traduce a una o mÃ¡s instrucciones mÃ¡quina.", "Una instrucciÃ³n que no tiene una representaciÃ³n binaria especÃ­fica."], c:2},
            {u:"UD3", q:"El lenguaje ensamblador:", o:["Es muy frecuentemente utilizado cuando no nos importa la eficiencia del cÃ³digo.", "Es muy parecido entre procesadores distintos, aunque depende de la arquitectura.", "Es mÃ¡s fÃ¡cil de programar, por eso se llama de bajo nivel.", "Permite programar un computador sin preocuparse de su arquitectura."], c:1},
            {u:"UD3", q:"Al respecto del procesador MIPS32:", o:["Para sumar dos posiciones de memoria no hace falta cargarlas en registros.", "Tiene un ancho de palabra de 2 bytes.", "El modo kernel es el modo de funcionamiento con mÃ¡s permisos sobre el hardware.", "Trabaja con cÃ³digos mÃ¡s complejos por tener mÃ¡s instrucciones."], c:2},

            // UD4
            {u:"UD4", q:"Â¿QuÃ© hace este cÃ³digo?\n.data\na: .word 6\nb: .word 3\nc: .word 0\n.text\nmain:\n   lw $t0, a\n   lw $t1, b\n   mul $t2, $t0, $t1\n   sw $t2, c\n   li $v0, 10\n   syscall", o:["Multiplica a y b y almacena el resultado en c.", "Suma a y b y almacena el resultado en c.", "Divide a por b y almacena el resultado en c.", "Resta b de a y almacena el resultado en c."], c:0},
            {u:"UD4", q:"Â¿QuÃ© hace la instrucciÃ³n 'lb' en MIPS32?", o:["Almacena un byte (8 bits) desde un registro en la memoria.", "Carga una palabra (32 bits) desde la memoria en un registro.", "Carga un byte (8 bits) desde la memoria en un registro, extendiÃ©ndolo con signo.", "Almacena una palabra (32 bits) desde un registro en la memoria."], c:2},
            {u:"UD4", q:"Â¿QuÃ© hace este cÃ³digo?\n.data\na: .word 8\nb: .word 3\nc: .word 0\n.text\nmain:\n   lw $t0, a\n   lw $t1, b\n   sub $t2, $t0, $t1\n   sw $t2, c\n   li $v0, 10\n   syscall", o:["Divide los valores de a y b y almacena el resultado en c.", "Resta el valor de b de a y almacena el resultado en c.", "Multiplica los valores de a y b y almacena el resultado en c.", "Suma los valores de a y b y almacena el resultado en c."], c:1},
            {u:"UD4", q:"Â¿QuÃ© instrucciÃ³n en MIPS32 se utiliza para cargar un byte desde la memoria en un registro, extendiÃ©ndolo con ceros (sin signo)?", o:["lbu", "lw", "lb", "sb"], c:0},
            {u:"UD4", q:"Â¿QuÃ© hace este cÃ³digo?\n.data\nx: .word 7\ny: .word 5\nz: .word 0\n.text\nmain:\n   lw $t0, x\n   lw $t1, y\n   beq $t0, $t1, equal\n   bne $t0, $t1, notequal\nequal:\n   li $t2, 1\n   j end\nnotequal:\n   li $t2, 0\nend:\n   sw $t2, z\n   li $v0, 10\n   syscall", o:["Compara x e y, almacena 0 en z si son iguales, de lo contrario almacena 1.", "Suma x e y y almacena el resultado en z.", "Compara x e y, almacena 1 en z si son iguales, de lo contrario almacena 0.", "Resta y de x y almacena el resultado en z."], c:2},
            {u:"UD4", q:"Â¿QuÃ© instrucciÃ³n en MIPS32 se utiliza para cargar una palabra desde la memoria en un registro?", o:["lb", "sb", "sw", "lw"], c:3},
            {u:"UD4", q:"Â¿QuÃ© instrucciÃ³n en MIPS32 se utiliza para cargar un valor inmediato en un registro?", o:["sw", "sb", "li", "lw"], c:2},
            {u:"UD4", q:"Â¿QuÃ© caracterÃ­stica tiene el formato de instrucciones en MIPS32?", o:["Formato variable de 8 a 32 bits.", "Formato variable de 16 a 64 bits.", "Formato fijo de 64 bits.", "Formato fijo de 32 bits."], c:3},
            {u:"UD4", q:"Â¿QuÃ© instrucciÃ³n en MIPS32 se utiliza para almacenar un byte desde un registro en la memoria?", o:["sw", "sb", "lb", "lw"], c:1},
            {u:"UD4", q:"Â¿QuÃ© hace este cÃ³digo?\n.data\nval: .word 16\nres: .word 0\n.text\nmain:\n   lw $t0, val\n   li $t1, 4\n   div $t0, $t1\n   mfhi $t2\n   sw $t2, res\n   li $v0, 10\n   syscall", o:["Suma val y 4 y almacena el resultado en res.", "Divide val por 4 y almacena el residuo en res.", "Divide val por 4 y almacena el cociente en res.", "Resta 4 de val y almacena el resultado en res."], c:1},

            // UD5
            {u:"UD5", q:"Â¿QuÃ© es la unidad de control en un procesador?", o:["La parte del procesador que maneja la entrada y salida de datos.", "La parte del procesador que gestiona y coordina las operaciones.", "La parte del procesador que almacena datos.", "La parte del procesador que realiza operaciones aritmÃ©ticas."], c:1},
            {u:"UD5", q:"SeÃ±ala la verdadera al respecto del MIPS32:", o:["Tiene 24 registros Ãºtiles.", "Trabaja indistintamente en cualquier modo.", "Tiene un ancho del bus de direcciones de 4 bytes.", "Tiene un ancho de palabra de 8 bytes."], c:2},
            {u:"UD5", q:"La unidad de control:", o:["Solo tiene circuitos combinacionales.", "No extrae informaciÃ³n de la ruta de datos.", "Puede cambiar el salto a su siguiente estado dependiendo de la ruta de datos.", "Trabaja sin reloj."], c:2},
            {u:"UD5", q:"Sobre el reloj del procesador:", o:["Es una seÃ±al sinusoidal.", "Puede tener cualquier velocidad.", "Es una seÃ±al diente de sierra.", "Es una seÃ±al cuadrada (ceros y unos)."], c:3},
            {u:"UD5", q:"Un ciclo de 1 ns son:", o:["2 G de frecuencia de reloj.", "No podemos saber la frecuencia de reloj.", "10 G de frecuencia de reloj.", "1G de frecuencia de reloj."], c:3},
            {u:"UD5", q:"Â¿QuÃ© es el bus de comunicaciÃ³n en un computador?", o:["Un dispositivo de almacenamiento.", "Un tipo de memoria de acceso aleatorio.", "Un conjunto de lÃ­neas de transmisiÃ³n que permiten la comunicaciÃ³n entre los componentes del hardware.", "Un dispositivo de entrada y salida."], c:2},
            {u:"UD5", q:"Â¿QuÃ© se hace en la fase de bÃºsqueda de instrucciÃ³n (FETCH)?", o:["Se ejecuta la instrucciÃ³n.", "Se decodifica la instrucciÃ³n.", "Se almacena el resultado de la instrucciÃ³n.", "Se busca la instrucciÃ³n en la memoria principal."], c:3},
            {u:"UD5", q:"Sobre la fase Fetch de ejecuciÃ³n de una instrucciÃ³n:", o:["Carga datos en memoria.", "Carga datos de memoria.", "No involucra a la memoria puesto que es la fase en la que traemos la instrucciÃ³n.", "Involucra al banco de registros."], c:1},
            {u:"UD5", q:"La ruta de datos:", o:["Solo alberga circuitos secuenciales.", "Contiene registros.", "Es una mÃ¡quina moore.", "Mueve datos sin ayuda de ningÃºn dispositvo."], c:1},
            {u:"UD5", q:"La ALU:", o:["Trabaja directamente con la memoria.", "La entrada zero pone a cero la ALU.", "Los bits del cÃ³digo de operaciÃ³n de la instrucciÃ³n le indican directamente quÃ© operaciÃ³n debe realizar.", "Solamente opera con registros."], c:3},

            // UD6
            {u:"UD6", q:"Â¿QuÃ© es la memoria volÃ¡til?", o:["Memoria que pierde los datos cuando se apaga el sistema.", "Memoria utilizada solo para la cachÃ©.", "Memoria que retiene los datos incluso sin energÃ­a.", "Memoria utilizada solo para almacenamiento externo."], c:0},
            {u:"UD6", q:"Â¿QuÃ© es un fallo de cachÃ©?", o:["Cuando la cachÃ© almacena datos permanentemente.", "Cuando el bloque solicitado no se encuentra en la cachÃ©.", "Cuando la cachÃ© no necesita ser refrescada.", "Cuando el bloque solicitado ya estÃ¡ en la cachÃ©."], c:1},
            {u:"UD6", q:"Â¿QuÃ© tipo de memoria es mÃ¡s rÃ¡pida pero tambiÃ©n mÃ¡s cara y con menor densidad de almacenamiento?", o:["SRAM.", "Memoria flash.", "DRAM.", "Memoria magnÃ©tica."], c:0},
            {u:"UD6", q:"Â¿QuÃ© principio sugiere que si se accede a un dato, es probable que se accedan a otros datos cercanos en la memoria?", o:["Localidad temporal.", "Acceso directo.", "Acceso aleatorio.", "Localidad espacial."], c:3},
            {u:"UD6", q:"Sobre el mÃ³dulo de E/S seÃ±ala la falsa:", o:["Gestiona la comunicaciÃ³n con el perifÃ©rico.", "Nunca almacena datos.", "Realiza el control y temporizaciÃ³n para evitar pÃ©rdidas de informaciÃ³n.", "Gestiona la comunicaciÃ³n con la CPU."], c:1},
            {u:"UD6", q:"Â¿QuÃ© tipo de memoria es volÃ¡til?", o:["Memoria flash.", "Memoria ROM.", "Discos duros.", "Memoria RAM."], c:3},
            {u:"UD6", q:"Â¿QuÃ© polÃ­tica de reemplazo de cachÃ© selecciona al azar un bloque para ser reemplazado?", o:["Reemplazo LRU.", "Reemplazo directo.", "Reemplazo aleatorio.", "Reemplazo FIFO."], c:2},
            {u:"UD6", q:"Sobre el programa:", o:["Se ejecuta leyendo las instrucciones del disco.", "Se compila desde el disco para ejecutarse.", "Se ejecutan leyendo las instrucciones de la memoria principal.", "EstÃ¡ escrito en lenguajes de alto nivel siempre."], c:2},
            {u:"UD6", q:"Â¿QuÃ© tipo de memoria se utiliza principalmente para almacenamiento externo y ofrece alta capacidad a un costo bajo?", o:["Memoria Ã³ptica.", "Memoria de semiconductores.", "Memoria magneto-Ã³ptica.", "Memoria magnÃ©tica."], c:3},
            {u:"UD6", q:"Â¿CuÃ¡l es una caracterÃ­stica de la memoria cachÃ©?", o:["Es utilizada solo para almacenamiento externo.", "Es mÃ¡s lenta que la memoria principal.", "Almacena datos de manera permanente.", "Almacena temporalmente los datos mÃ¡s frecuentemente utilizados."], c:3}
        ];

        let questions = [];
        let hits = 0, fails = 0, done = 0;

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function initQuiz() {
            questions = JSON.parse(JSON.stringify(rawQuestions));
            shuffle(questions);
            hits = 0; fails = 0; done = 0;
            updateStats();
            render();
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function updateStats() {
            document.getElementById('hits').innerText = hits;
            document.getElementById('fails').innerText = fails;
            document.getElementById('current').innerText = `${done}/${questions.length}`;
        }

        function render() {
            const box = document.getElementById('quiz-box');
            box.innerHTML = '';
            questions.forEach((data, i) => {
                const card = document.createElement('div');
                card.className = 'q-card';
                card.innerHTML = `
                    <span class="unit-badge">${data.u}</span>
                    <div class="question-text"><strong>${i+1}.</strong> ${data.q}</div>
                    <div class="options-container" id="opts-${i}">
                        ${data.o.map((opt, oi) => `<div class="option" onclick="check(${i}, ${oi})">${opt}</div>`).join('')}
                    </div>
                `;
                box.appendChild(card);
            });
        }

        window.check = (qi, oi) => {
            const container = document.getElementById(`opts-${qi}`);
            if(container.classList.contains('disabled')) return;
            const options = container.querySelectorAll('.option');
            const correct = questions[qi].c;
            if(oi === correct) {
                options[oi].classList.add('correct');
                hits++;
            } else {
                options[oi].classList.add('wrong');
                options[correct].classList.add('correct');
                fails++;
            }
            done++;
            container.classList.add('disabled');
            updateStats();
            if(done === questions.length) showFinalResults();
        };

        function showFinalResults() {
            const grade = ((hits / questions.length) * 10).toFixed(2);
            document.getElementById('final-stats').innerHTML = `
                <div style="font-size: 1.1rem">
                    Aciertos: <span style="color:var(--success)">${hits}</span><br>
                    Fallos: <span style="color:var(--error)">${fails}</span><br>
                    Nota Final: <span style="font-size:2rem; font-weight:bold">${grade} / 10</span>
                </div>
            `;
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('results-modal').style.display = 'block';
        }

        initQuiz();
    </script>
</body>
</html>