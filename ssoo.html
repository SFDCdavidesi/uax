<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UAX - Test EXCLUSIVO Sistemas Operativos</title>
    <style>
        :root { --primary: #2563eb; --success: #059669; --error: #dc2626; --bg: #f1f5f9; --card: #ffffff; --text: #0f172a; }
        body { font-family: system-ui, -apple-system, sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .header { position: sticky; top: 0; background: var(--card); width: 100%; max-width: 650px; padding: 15px; border-radius: 0 0 15px 15px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); z-index: 1000; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
        .stat { text-align: center; }
        .stat-val { display: block; font-weight: 800; font-size: 1.2rem; }
        .stat-label { font-size: 0.7rem; color: #64748b; text-transform: uppercase; }
        .shuffle-btn { grid-column: span 3; background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .quiz-container { width: 100%; max-width: 650px; }
        .q-card { background: var(--card); padding: 18px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .unit-badge { background: #e2e8f0; color: #475569; padding: 2px 8px; border-radius: 5px; font-size: 0.7rem; font-weight: bold; }
        .question-text { font-size: 1rem; font-weight: 600; margin: 12px 0; line-height: 1.4; }
        .option { padding: 12px; border: 2px solid #f1f5f9; border-radius: 10px; margin-bottom: 8px; cursor: pointer; font-size: 0.9rem; transition: all 0.2s; background: #fdfdfd; }
        .option:hover { border-color: #cbd5e1; }
        .disabled { pointer-events: none; }
        .correct { background: #dcfce7 !important; border-color: var(--success) !important; color: #166534; }
        .wrong { background: #fee2e2 !important; border-color: var(--error) !important; color: #991b1b; }
        #results-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 20px; box-shadow: 0 0 50px rgba(0,0,0,0.3); text-align: center; z-index: 2000; width: 80%; max-width: 400px; }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1999; }
    </style>
</head>
<body>

    <div class="header">
        <div class="stat"><span class="stat-val" id="hits">0</span><span class="stat-label">Aciertos</span></div>
        <div class="stat"><span class="stat-val" id="fails">0</span><span class="stat-label">Fallos</span></div>
        <div class="stat"><span class="stat-val" id="current">0/60</span><span class="stat-label">Progreso</span></div>
        <button class="shuffle-btn" onclick="initQuiz()">游 Mezclar y Reiniciar</button>
    </div>

    <div class="quiz-container" id="quiz-box"></div>

    <div class="overlay" id="overlay"></div>
    <div id="results-modal">
        <h2>游꿀 춰Fin del Test!</h2>
        <div id="final-stats" style="margin: 20px 0; line-height: 2;"></div>
        <button class="shuffle-btn" onclick="closeModal()">游댃 Volver a intentar</button>
    </div>

    <script>
        const rawQuestions = [
            // UD1 - SSOO
            {u:"UD1", q:"쮼l sistema operativo interviene en la operaci칩n de la memoria cach칠?", o:["S칤, para garantizar que almacene la informaci칩n adecuada.", "S칤, pero s칩lo cuando se produce un error.", "S칤, para buscar en ella la informaci칩n solicitada.", "No, es gestionada exclusivamente por el hardware."], c:3},
            {u:"UD1", q:"Un archivo de cabecera contiene", o:["Prototipos de funciones.", "Declaraciones de variables", "Funciones reutilizables.", "Nombres de archivos fuente."], c:0},
            {u:"UD1", q:"Si en el c칩digo tenemos la sentencia a[0]=1", o:["&a es igual a & (a[0])", "&a es igual a a[0]", "a es igual a*(a[0])", "*a es igual a *(&a[0])"], c:3},
            {u:"UD1", q:"Si una variable est치 definida fuera de cualquier funci칩n, se tratar치", o:["De una variable local al m칩dulo donde se defina.", "De una variable global.", "De una constante.", "De un puntero."], c:1},
            {u:"UD1", q:"쮺u치l de los siguientes no es un registro de la Unidad de Control?", o:["Registro de instrucci칩n.", "Registro de datos.", "Registro de estado.", "Contador de programa."], c:1},
            {u:"UD1", q:"Es falso que la funci칩n printf", o:["Se define en stdio.h.", "Se define en stdlib.h.", "Utiliza %d para mostrar enteros.", "Utiliza %lf para mostrar valores reales."], c:1},
            {u:"UD1", q:"El controlador de un dispositivo de E/S", o:["Atiende las interrupciones causadas por el dispositivo.", "Necesita siempre al procesador para transferir datos a memoria.", "Eleva las interrupciones correspondientes al dispositivo.", "Es un elemento software que gobierna la ejecuci칩n del dispositivo."], c:2},
            {u:"UD1", q:"Es falso que la funci칩n scanf", o:["Se define en stdio.h.", "Utiliza %d para leer enteros.", "Necesita la direcci칩n de memoria de la variable donde almacena el valor.", "Utiliza %c para leer reales."], c:3},
            {u:"UD1", q:"Podemos considerar que en un computador existen", o:["S칩lo dos flujos de entrada: uno de datos y otro de instrucciones.", "Un flujo de entrada (datos e instrucciones) y otro de salida.", "Dos flujos de entrada (datos e instrucciones) y otro de salida (resultados).", "Dos flujos de entrada (datos e instrucciones) y dos de salida (resultados y errores)."], c:2},
            {u:"UD1", q:"쮺u치l es el mecanismo que no permite cambiar el modo de ejecuci칩n de usuario a n칰cleo?", o:["La instrucci칩n RETI.", "La recepci칩n de una interrupci칩n.", "La ejecuci칩n de una operaci칩n de entrada/salida.", "La ejecuci칩n de un servicio del sistema operativo."], c:0},
            // UD2 - SSOO
            {u:"UD2", q:"La funci칩n pthread_join sirve para:", o:["Crear una hebra", "Detener una hebra", "Esperar a una hebra", "Iniciar una hebra"], c:2},
            {u:"UD2", q:"Un proceso es", o:["El contenido del segmento de c칩digo de un programa.", "Una entidad l칩gica creada por el Sistema Operativo.", "Un archivo ejecutable.", "Un servicio del sistema operativo."], c:1},
            {u:"UD2", q:"El tercer par치metro de la funci칩n pthread_create indica:", o:["Los argumentos con que se llamar치 a la funci칩n sobre la que se crea una hebra", "El c칩digo de la funci칩n sobre la que se crea una hebra", "La estructura que almacenar치 los datos de la hebra", "Los atributos con que se llamar치 a la funci칩n sobre la que se crea una hebra"], c:1},
            {u:"UD2", q:"쮺u치l de la siguiente informaci칩n no es almacenada por el BCP de un proceso?", o:["Ultima instrucci칩n ejecutada", "M치scara de interrupciones.", "Referencia a los archivos abiertos", "Referencia al segmento de c칩digo del proceso."], c:0},
            {u:"UD2", q:"Un proceso en estado bloqueado", o:["Puede pasar directamente a estado de ejecuci칩n.", "Puede haber realizado una transici칩n a este estado desde el estado de listo.", "Tiene todos los recursos y elementos que necesita para reanudar su ejecuci칩n.", "Ha pasado al menos una vez por el estado de ejecuci칩n."], c:3},
            {u:"UD2", q:"La funci칩n sobre la que se cree una hebra", o:["Puede recibir m치s de un par치metro.", "Puede recibir m치s de un par치metro si todos son punteros.", "No puede recibir m치s de un par치metro.", "Puede recibir m치s de un par치metro si todos son punteros a void (* void)."], c:2},
            {u:"UD2", q:"Si un proceso se encuentra en estado de ejecuci칩n:", o:["Su estado hardware se almacena en la pila de usuario.", "Su estado hardware se almacena en los registros del procesador.", "Su estado hardware se almacena en su BCP.", "Su estado hardware se almacena en la pila del sistema."], c:1},
            {u:"UD2", q:"Se dice que entre dos procesos existe una relaci칩n padre-hijo si:", o:["Uno ha sido creado por el sistema operativo a instancias del otro.", "Ambos pertenecen a la misma familia de procesos.", "Ambos comparten los mismos recursos.", "Ambos forman parte de la misma aplicaci칩n."], c:0},
            {u:"UD2", q:"Es falso que el BCP de un proceso pueda encontrarse:", o:["En espacio de memoria del sistema.", "Enlazado en una lista de procesos en estado listo.", "En memoria secundaria.", "Enlazado en una lista de procesos bloqueados."], c:2},
            {u:"UD2", q:"Las hebras definidas sobre un proceso", o:["Tienen cada una un BCP diferente.", "Tienen cada una su propio segmento de c칩digo.", "Tienen cada una su propio segmento de datos.", "Tienen cada una su propio estado del procesador."], c:3},
            // UD3 - SSOO
            {u:"UD3", q:"Suponga una pol칤tica de planificaci칩n basada en FCFS", o:["Si un proceso ocupa el procesador puede ejecutar hasta terminar.", "Un proceso esperar치 a que terminen todos los que han llegado antes incluso si se bloquean.", "Si un proceso se bloquea continuar치 ejecutando en el mismo orden tras el bloqueo.", "Si un proceso abandona el procesador es porque se ha bloqueado."], c:0},
            {u:"UD3", q:"El planificador a corto plazo:", o:["Se ejecuta para decidir qu칠 proceso suspendido es tra칤do a memoria.", "Se ejecuta para decidir qu칠 proceso bloqueado es reanudado.", "Se ejecuta para decidir qu칠 proceso es suspendido.", "Se ejecuta para decidir qu칠 proceso en estado de listo toma el control del procesador."], c:3},
            {u:"UD3", q:"El segundo par치metro de la funci칩n sched_setaffinity determina:", o:["Los procesadores sobre los que el proceso ejecutar치.", "El tama침o de la m치scara de procesadores.", "El pid del proceso", "Los procesadores sobre los que el proceso no ejecutar치."], c:1},
            {u:"UD3", q:"Suponga una pol칤tica de planificaci칩n de colas multinivel y prioridad est치tica:", o:["Los procesos pasan por todas las colas multinivel.", "Los procesos pueden ejecutar durante un quantum distinto en funci칩n de la cola.", "Los procesos cambian de cola multinivel cuando agotan el quantum de su cola.", "Un proceso ejecuta durante el mismo quantum independientemente de la cola."], c:1},
            {u:"UD3", q:"En una pol칤tica de planificaci칩n expropiativa:", o:["El sistema operativo puede tomar el control del procesador en cualquier momento.", "El sistema operativo ocupa el procesador durante un tiempo y no cede el procesador a ning칰n proceso hasta que ese tiempo concluye.", "El sistema operativo no tiene autoridad para expropiar a cualquier proceso del procesador en cualquier momento.", "Si un proceso obtiene el control del procesador no lo deja hasta que concluye su ejecuci칩n."], c:0},
            {u:"UD3", q:"Suponga una pol칤tica de planificaci칩n Round-Robin con quantum q=6", o:["Un proceso nunca podr치 esperar por m치s de 6 u.t. seguidas.", "Un proceso nunca podr치 ejecutar por m치s de 6 u.t. seguidas.", "Un proceso no podr치 volver a ejecutar tras haber estado 6 u.t. en ejecuci칩n.", "El tiempo de retorno del proceso es como m칤nimo de 6 u.t."], c:1},
            {u:"UD3", q:"Suponga una pol칤tica de planificaci칩n basada en FCFS (desbloqueo)", o:["Si un proceso es desbloqueado se insertar치 al frente de la cola de listos.", "Si un proceso es desbloqueado tomar치 autom치ticamente el control del procesador.", "Si un proceso es desbloqueado puede tener que esperar a que acaben todos los insertados en la cola de listos.", "Si un proceso es desbloqueado no podr치 ejecutar ininterrumpidamente cuando pase a ejecuci칩n."], c:2},
            {u:"UD3", q:"La funci칩n sched_setaffinity:", o:["No tiene efecto si hay un solo procesador.", "Puede vaciar una m치scara de procesadores.", "Es una macro.", "Puede asignar procesadores a una m치scara."], c:0},
            {u:"UD3", q:"쮺u치ntos niveles de prioridad se establecen para la pol칤tica SCHED_RR en Linux?", o:["140", "100", "139", "99"], c:3},
            {u:"UD3", q:"Suponga una pol칤tica de planificaci칩n Round-Robin con quantum q=4", o:["Un proceso en estado listo no podr치 esperar m치s de 6 u.t.", "Un proceso en estado listo podr치 esperar menos de 6 u.t.", "Un proceso en estado suspendido no podr치 esperar m치s de 6 u.t.", "Un proceso en estado bloqueado no podr치 esperar m치s de 6 u.t."], c:1},
            // UD4 - SSOO
            {u:"UD4", q:"Dos procesos que utilicen memoria compartida:", o:["Tienen que tener acceso al mismo sistema de ficheros.", "Tienen que ser hijos del mismo padre.", "Tienen que ser padre-hijo.", "Tienen que pertenecer al mismo usuario."], c:0},
            {u:"UD4", q:"En un pipe:", o:["No se suele intercambiar informaci칩n de manera unidireccional.", "No se suele intercambiar informaci칩n de manera bidireccional.", "No hay llamadas bloqueantes.", "No se puede establecer comunicaci칩n entre procesos ubicados en m치quinas distintas."], c:3},
            {u:"UD4", q:"El quinto par치metro de la primitiva mmap corresponde a:", o:["El archivo que se proyectar치.", "La zona de memoria compartida.", "La zona de memoria que se proyectar치.", "El espacio local que se habr치 reservado para la memoria compartida."], c:0},
            {u:"UD4", q:"El segundo par치metro de la llamada a pthread_cond_wait corresponde a un mutex que:", o:["Si est치 abierto, el proceso no quedar치 bloqueado en la llamada.", "Si est치 cerrado, se abrir치.", "Se bloquear치 en la llamada.", "Se liberar치 en la llamada."], c:3},
            {u:"UD4", q:"Si un sem치foro general tiene valor 2:", o:["No puede haber procesos en la regi칩n cr칤tica que controle.", "Ning칰n proceso que invoque a wait podr치 entrar en regi칩n cr칤tica.", "Puede haber procesos en la regi칩n cr칤tica que controle.", "Una llamada a signal no tendr치 efecto sobre el contador."], c:2},
            {u:"UD4", q:"Si un sem치foro general tiene valor 0:", o:["No puede haber procesos en la regi칩n cr칤tica que controle.", "Una llamada a signal dejar치 siempre el sem치foro a valor 1.", "Ning칰n proceso que invoque a wait podr치 entrar en regi칩n cr칤tica.", "Una llamada a signal no tendr치 efecto sobre el contador."], c:2},
            {u:"UD4", q:"En la llamada a read sobre un pipe:", o:["El segundo par치metro indica la posici칩n de memoria sobre la que se escribir치 lo le칤do del pipe.", "El segundo par치metro indica la posici칩n de memoria que se escribir치 en el pipe.", "El segundo par치metro indica la posici칩n de memoria sobre la que se escribir치 lo escrito en el pipe.", "El segundo par치metro indica la posici칩n de memoria sobre la que se leer치."], c:0},
            {u:"UD4", q:"Un recurso cr칤tico, necesariamente:", o:["Tiene que ser accedido secuencialmente por los procesos o hebras.", "Tiene que ser accedido dentro de una regi칩n cr칤tica.", "Tiene que ser accedido en exclusi칩n mutua.", "Siempre tiene que poder ser accedido simult치neamente por m치s de un proceso."], c:1},
            {u:"UD4", q:"Sea una regi칩n cr칤tica donde puede haber hasta dos procesos en ejecuci칩n:", o:["La regi칩n puede ser controlada por un sem치foro binario.", "Si la regi칩n es controlada por un sem치foro general este se inicializa a -2", "La regi칩n no puede ser controlada por un sem치foro binario.", "Si la regi칩n es controlada por un sem치foro general este se inicializa a cero."], c:2},
            {u:"UD4", q:"El segundo par치metro de la llamada a pthread_cond_wait corresponde a un mutex que (propiedad):", o:["Quedar치 en posesi칩n del proceso que invoque a pthread_cond_wait.", "Puede estar abierto.", "Puede estar bloqueado por otro proceso.", "Quedar치 abierto si estaba cerrado."], c:2},
            // UD5 - SSOO
            {u:"UD5", q:"Una zona de memoria compartida:", o:["Pueden utilizar referencias l칩gicas normales para referenciar elementos en su interior.", "Comienzan siempre en la posici칩n 1.", "Pueden contener direcciones f칤sicas referenciadas por direcciones l칩gicas distintas en los espacios de memoria de los procesos que la comparten.", "No pueden contener direcciones f칤sicas referenciadas por direcciones l칩gicas distintas."], c:2},
            {u:"UD5", q:"Las funciones de bibliotecas est치ticas", o:["Se integran en los archivos ejecutables.", "Se invocan a trav칠s de una llamada al sistema operativo.", "No tienen que ser reenlazadas si la biblioteca se actualiza.", "No tienen que ser recompiladas si la biblioteca se actualiza."], c:0},
            {u:"UD5", q:"En un esquema de memoria virtual basado en segmentaci칩n.", o:["No pueden utilizarse tablas de p치ginas.", "Cada segmento tendr치 sus propios permisos de acceso.", "Los segmentos tendr치n tama침o fijo.", "Todos los segmentos estar치n siempre cargados en memoria principal."], c:1},
            {u:"UD5", q:"Las direcciones l칩gicas de un proceso:", o:["Son la entrada a la MMU.", "Referencian posiciones de memoria f칤sica.", "Comienzan siempre en la posici칩n 1.", "No pueden ser iguales para cada proceso."], c:0},
            {u:"UD5", q:"Con particiones din치micas:", o:["Hay fragmentaci칩n interna.", "Hay fragmentaci칩n externa.", "Un proceso puede ocupar dos zonas separadas.", "La eficiencia del almacenamiento no depende del algoritmo de asignaci칩n."], c:1},
            {u:"UD5", q:"En un esquema de memoria virtual basado en segmentaci칩n (divisi칩n):", o:["Un segmento puede incluir elementos como c칩digo y variables.", "El segmento de c칩digo tiene que estar enteramente cargado en memoria principal.", "Dos procesos no pueden compartir un mismo segmento.", "Cada segmento se corresponde con una divisi칩n de la imagen de memoria del proceso."], c:3},
            {u:"UD5", q:"En un esquema de memoria virtual basado en segmentaci칩n (desplazamiento):", o:["No hace falta el desplazamiento dentro del segmento para acceder a una posici칩n f칤sica.", "El desplazamiento dentro del segmento s칩lo figura en la direcci칩n f칤sica.", "El desplazamiento tiene que ser comparado con la longitud de 칠ste.", "El desplazamiento dentro del segmento s칩lo figura en la direcci칩n l칩gica."], c:2},
            {u:"UD5", q:"En memoria virtual que utilice un esquema de paginaci칩n:", o:["Dado un n칰mero de p치gina no es posible conocer su direcci칩n l칩gica de inicio.", "Dado un n칰mero de marco no es posible conocer su direcci칩n f칤sica de inicio.", "Dado un n칰mero de p치gina es posible conocer su direcci칩n f칤sica de inicio.", "Dado un n칰mero de marco es posible conocer su direcci칩n f칤sica de inicio."], c:3},
            {u:"UD5", q:"Con particiones din치micas (fragmentaci칩n):", o:["Un proceso puede ocupar dos particiones si no hay una lo suficiente grande para ubicarlo.", "No hay fragmentaci칩n interna.", "La eficiencia del almacenamiento no depende de la partici칩n.", "No hay fragmentaci칩n externa."], c:1},
            {u:"UD5", q:"En memoria virtual que utilice un esquema de paginaci칩n (direcciones):", o:["El segmento de c칩digo tiene que almacenarse en una p치gina.", "Las direcciones de entrada a la MMU son direcciones f칤sicas.", "Las direcciones l칩gicas coinciden con las direcciones secuenciales del proceso.", "Las direcciones f칤sicas coinciden con las direcciones secuenciales del proceso."], c:2},
            // UD6 - SSOO
            {u:"UD6", q:"El tercer par치metro de la llamada al sistema open", o:["S칩lo tiene sentido si el archivo indicado no existe.", "Establece los privilegios para el usuario propietario del proceso que abre el archivo.", "Establece los privilegios para el proceso que abre el archivo.", "Indican si el archivo se abre para lectura y/o escritura."], c:0},
            {u:"UD6", q:"El controlador de un dispositivo:", o:["Es el hardware del sistema al que se conecta un nuevo perif칠rico.", "Es el software del sistema que env칤a 칩rdenes al perif칠rico.", "Puede insertar valores en los registros del procesador.", "Puede insertar valores en la memoria principal del sistema."], c:3},
            {u:"UD6", q:"Si se utiliza una entrada/salida por interrupciones:", o:["S칩lo se puede atender a una interrupci칩n cuando se ejecute un proceso de usuario.", "No se puede interrumpir la rutina de tratamiento de una interrupci칩n.", "La atenci칩n de una interrupci칩n siempre se realiza en modo n칰cleo.", "Se puede ejecutar un proceso de usuario para atender a una interrupci칩n."], c:2},
            {u:"UD6", q:"El primer par치metro de la llamada al sistema write:", o:["Especifica la ruta del archivo sobre el que se va a escribir.", "Especifica la entrada en la tabla de archivos abiertos del archivo sobre el que se va a escribir.", "Especifica el inodo del archivo sobre el que se va a escribir.", "Especifica un buffer de escritura."], c:1},
            {u:"UD6", q:"Si se utiliza una entrada/salida por DMA:", o:["Se emite una interrupci칩n cuando los datos est치n en memoria.", "El proceso que solicita una operaci칩n puede seguir ejecutando y se le enviar치 una interrupci칩n.", "El proceso interrumpido s칤 puede ser el mismo que solicit칩 la operaci칩n.", "La interrupci칩n es tratada por el proceso que solicit칩 la operaci칩n."], c:0},
            {u:"UD6", q:"En S_ISDIR(m):", o:["m corresponde al nombre del directorio a comprobar.", "S_ISDIR es una llamada al sistema operativo.", "m corresponde al modo del archivo a comprobar.", "S_ISDIR puede ejecutarse de forma independiente a fstat."], c:2},
            {u:"UD6", q:"Un enlace blando es:", o:["El nombre de un archivo.", "La entrada de un directorio", "Un archivo que contiene la ruta de otro.", "Un archivo que tiene los inodos de otro archivo."], c:2},
            {u:"UD6", q:"En los sistemas de archivos basados en inodos:", o:["Un bloque referenciado desde otro puede contener datos o direcciones a otros bloques.", "Los bloques del sistema de archivos pueden contener datos y apuntadores a otros bloques.", "Los datos del archivo pueden almacenarse en distintos inodos.", "Los bloques del sistema de archivos s칩lo pueden contener datos."], c:0},
            {u:"UD6", q:"La llamada al sistema lseek(3, 0, SEEK_END):", o:["Sit칰a el puntero en la posici칩n 0 para la salida de error est치ndar.", "Sit칰a el puntero al final del primer archivo abierto desde el proceso.", "Sit칰a el puntero al final del 칰ltimo archivo abierto desde el proceso.", "Sit칰a el puntero en la posici칩n 0 para la salida est치ndar."], c:1},
            {u:"UD6", q:"Si se utiliza una entrada/salida por DMA (bloqueo):", o:["El controlador del dispositivo no puede escribir en memoria.", "El controlador del dispositivo interrumpe para que el SO lleve los datos.", "El proceso que solicita una operaci칩n queda bloqueado hasta que 칠sta se complete.", "El proceso que solicita una operaci칩n puede continuar su ejecuci칩n."], c:2}
        ];

        let questions = [];
        let hits = 0, fails = 0, done = 0;

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function initQuiz() {
            questions = JSON.parse(JSON.stringify(rawQuestions));
            shuffle(questions);
            hits = 0; fails = 0; done = 0;
            updateStats();
            render();
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function updateStats() {
            document.getElementById('hits').innerText = hits;
            document.getElementById('fails').innerText = fails;
            document.getElementById('current').innerText = `${done}/${questions.length}`;
        }

        function render() {
            const box = document.getElementById('quiz-box');
            box.innerHTML = '';
            questions.forEach((data, i) => {
                const card = document.createElement('div');
                card.className = 'q-card';
                card.innerHTML = `
                    <span class="unit-badge">${data.u}</span>
                    <div class="question-text"><strong>${i+1}.</strong> ${data.q}</div>
                    <div class="options-container" id="opts-${i}">
                        ${data.o.map((opt, oi) => `<div class="option" onclick="check(${i}, ${oi})">${opt}</div>`).join('')}
                    </div>
                `;
                box.appendChild(card);
            });
        }

        window.check = (qi, oi) => {
            const container = document.getElementById(`opts-${qi}`);
            if(container.classList.contains('disabled')) return;
            
            const options = container.querySelectorAll('.option');
            const correct = questions[qi].c;
            
            if(oi === correct) {
                options[oi].classList.add('correct');
                hits++;
            } else {
                options[oi].classList.add('wrong');
                options[correct].classList.add('correct');
                fails++;
            }
            
            done++;
            container.classList.add('disabled');
            updateStats();
            
            if(done === questions.length) showFinalResults();
        };

        function showFinalResults() {
            const grade = ((hits / questions.length) * 10).toFixed(2);
            document.getElementById('final-stats').innerHTML = `
                <div style="font-size: 1.1rem">
                    Aciertos: <span style="color:var(--success); font-weight:bold">${hits}</span><br>
                    Fallos: <span style="color:var(--error); font-weight:bold">${fails}</span><br>
                    <strong>Nota final: ${grade} / 10</strong>
                </div>
            `;
            document.getElementById('results-modal').style.display = 'block';
            document.getElementById('overlay').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('results-modal').style.display = 'none';
            document.getElementById('overlay').style.display = 'none';
            initQuiz();
        }

        // Iniciar al cargar la p치gina
        initQuiz();
    </script>
</body>
</html>